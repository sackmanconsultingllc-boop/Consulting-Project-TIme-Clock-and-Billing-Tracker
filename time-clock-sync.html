<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Clock - Cloud Sync</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #151b3d;
            --bg-card: #1a2142;
            --accent-primary: #00f5d4;
            --accent-secondary: #6c5ce7;
            --accent-tertiary: #fd79a8;
            --text-primary: #ffffff;
            --text-secondary: #a8b2d1;
            --text-muted: #6c7a9b;
            --border: #2d3561;
            --success: #00d9a5;
            --warning: #ffd93d;
            --danger: #ff6b9d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Manrope', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(108, 92, 231, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 245, 212, 0.1) 0%, transparent 50%);
            animation: pulse 20s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes pulse {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(-5%, -5%) scale(1.05); }
        }

        .app-container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease-out;
        }

        h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.03em;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 500;
        }

        .sync-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(0, 245, 212, 0.1);
            border: 1px solid var(--accent-primary);
            border-radius: 2rem;
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }

        .sync-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-primary);
            animation: blink 2s ease-in-out infinite;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
            animation: fadeIn 1s ease-out 0.3s both;
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 1.5rem;
            padding: 2rem;
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px rgba(0, 245, 212, 0.1);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
        }

        .time-display {
            text-align: center;
            padding: 2rem;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, rgba(108, 92, 231, 0.2), rgba(0, 245, 212, 0.2));
            border-radius: 1rem;
            border: 1px solid var(--border);
        }

        .timer {
            font-family: 'JetBrains Mono', monospace;
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 0.5rem;
            letter-spacing: 0.05em;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .status-indicator.active {
            background: rgba(0, 217, 165, 0.2);
            color: var(--success);
        }

        .status-indicator.inactive {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-muted);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
            animation: blink 2s ease-in-out infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        input, select, textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            color: var(--text-primary);
            font-family: 'Manrope', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(0, 245, 212, 0.1);
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 0.75rem;
            font-family: 'Manrope', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--bg-primary);
            width: 100%;
            margin-top: 1rem;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 245, 212, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #ff4757);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 107, 157, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #00b894);
            color: var(--bg-primary);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 217, 165, 0.3);
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        .btn-edit {
            background: rgba(108, 92, 231, 0.2);
            color: var(--accent-secondary);
            border: 1px solid var(--accent-secondary);
        }

        .btn-edit:hover {
            background: rgba(108, 92, 231, 0.3);
        }

        .btn-delete {
            background: rgba(255, 107, 157, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .btn-delete:hover {
            background: rgba(255, 107, 157, 0.3);
        }

        .history-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            animation: slideIn 0.5s ease-out backwards;
        }

        .history-item:hover {
            border-color: var(--accent-primary);
            transform: translateX(5px);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .history-client {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-primary);
        }

        .history-duration {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-secondary);
        }

        .history-project {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .history-time {
            font-size: 0.875rem;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        .history-notes {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--bg-card);
            border-radius: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--accent-primary);
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 0.5rem;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .delete-btn {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .delete-btn:hover {
            background: rgba(255, 107, 157, 0.1);
            transform: scale(1.1);
        }

        .filters-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .export-section {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .btn-export {
            background: linear-gradient(135deg, #00b894, #00d9a5);
            color: var(--bg-primary);
            flex: 1;
            min-width: 200px;
        }

        .btn-export:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 217, 165, 0.3);
        }

        .clear-filters {
            background: rgba(255, 107, 157, 0.1);
            color: var(--danger);
            border: 1px solid var(--danger);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .clear-filters:hover {
            background: rgba(255, 107, 157, 0.2);
        }

        .nav-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border);
            padding: 0 1rem;
        }

        .nav-tab {
            padding: 1rem 2rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-family: 'Manrope', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .nav-tab:hover {
            color: var(--text-primary);
        }

        .nav-tab.active {
            color: var(--accent-primary);
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            animation: slideIn 0.3s ease-out;
        }

        .page-content {
            animation: fadeIn 0.4s ease-out;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
        }

        .settings-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 1.5rem;
            padding: 2rem;
        }

        .settings-section h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
        }

        .item-list {
            margin-top: 1.5rem;
        }

        .item-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .item-card:hover {
            border-color: var(--accent-primary);
            transform: translateX(3px);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .item-name {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-primary);
        }

        .item-rate {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-secondary);
        }

        .item-details {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .item-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .badge-active {
            background: rgba(0, 217, 165, 0.2);
            color: var(--success);
        }

        .badge-inactive {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-muted);
        }

        .input-group {
            display: flex;
            gap: 0.5rem;
        }

        .input-addon {
            display: flex;
            align-items: center;
            padding: 0.875rem 1rem;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 14, 39, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease-out;
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 1.5rem;
            padding: 2.5rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .modal-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            line-height: 1;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            color: var(--text-primary);
            transform: rotate(90deg);
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .auth-container {
            max-width: 500px;
            margin: 4rem auto;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 1.5rem;
            padding: 3rem;
            text-align: center;
        }

        .auth-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            color: var(--accent-primary);
        }

        .auth-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 1rem;
            margin-bottom: 2rem;
        }

        .user-email {
            color: var(--accent-primary);
            font-weight: 600;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            h1 {
                font-size: 2rem;
            }

            .timer {
                font-size: 2.5rem;
            }

            .settings-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 640px) {
            .app-container {
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .history-header {
                flex-direction: column;
                gap: 0.5rem;
            }

            .export-section {
                flex-direction: column;
            }

            .btn-export {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBUgFhsv4dh8vJCKtS-ytag4hXCvmrTRyg",
            authDomain: "time-clock-64172.firebaseapp.com",
            databaseURL: "https://time-clock-64172-default-rtdb.firebaseio.com",
            projectId: "time-clock-64172",
            storageBucket: "time-clock-64172.firebasestorage.app",
            messagingSenderId: "360147764920",
            appId: "1:360147764920:web:1139ddd56945025f58564d",
            measurementId: "G-X3F7DS680S"
        };

        // Initialize Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }

        const auth = firebase.auth();
        const database = firebase.database();

        function App() {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [currentPage, setCurrentPage] = useState('timeclock');
            const [isTracking, setIsTracking] = useState(false);
            const [currentTime, setCurrentTime] = useState(0);
            const [startTime, setStartTime] = useState(null);
            const [currentEntry, setCurrentEntry] = useState({
                client: '',
                project: '',
                notes: ''
            });
            const [history, setHistory] = useState([]);
            const [clients, setClients] = useState([]);
            const [projects, setProjects] = useState([]);
            
            const [filters, setFilters] = useState({
                client: '',
                project: '',
                startDate: '',
                endDate: ''
            });

            const [showClientModal, setShowClientModal] = useState(false);
            const [showProjectModal, setShowProjectModal] = useState(false);
            const [editingClient, setEditingClient] = useState(null);
            const [editingProject, setEditingProject] = useState(null);

            const [clientForm, setClientForm] = useState({
                name: '',
                rate: '',
                notes: '',
                active: true
            });

            const [projectForm, setProjectForm] = useState({
                name: '',
                client: '',
                rate: '',
                notes: '',
                active: true
            });

            // Auth state listener
            useEffect(() => {
                const unsubscribe = auth.onAuthStateChanged((user) => {
                    setUser(user);
                    setLoading(false);
                });
                return unsubscribe;
            }, []);

            // Firebase sync - History
            useEffect(() => {
                if (!user) return;
                
                const historyRef = database.ref(`users/${user.uid}/history`);
                historyRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        const historyArray = Object.keys(data).map(key => ({
                            ...data[key],
                            id: key
                        }));
                        setHistory(historyArray.sort((a, b) => 
                            new Date(b.startTime) - new Date(a.startTime)
                        ));
                    } else {
                        setHistory([]);
                    }
                });

                return () => historyRef.off();
            }, [user]);

            // Firebase sync - Clients
            useEffect(() => {
                if (!user) return;
                
                const clientsRef = database.ref(`users/${user.uid}/clients`);
                clientsRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        const clientsArray = Object.keys(data).map(key => ({
                            ...data[key],
                            id: key
                        }));
                        setClients(clientsArray);
                    } else {
                        setClients([]);
                    }
                });

                return () => clientsRef.off();
            }, [user]);

            // Firebase sync - Projects
            useEffect(() => {
                if (!user) return;
                
                const projectsRef = database.ref(`users/${user.uid}/projects`);
                projectsRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        const projectsArray = Object.keys(data).map(key => ({
                            ...data[key],
                            id: key
                        }));
                        setProjects(projectsArray);
                    } else {
                        setProjects([]);
                    }
                });

                return () => projectsRef.off();
            }, [user]);

            // Timer effect
            useEffect(() => {
                let interval;
                if (isTracking) {
                    interval = setInterval(() => {
                        setCurrentTime(Date.now() - startTime);
                    }, 1000);
                }
                return () => clearInterval(interval);
            }, [isTracking, startTime]);

            // Auth functions
            const signInWithGoogle = async () => {
                try {
                    const provider = new firebase.auth.GoogleAuthProvider();
                    await auth.signInWithPopup(provider);
                } catch (error) {
                    alert('Error signing in: ' + error.message);
                }
            };

            const signOut = async () => {
                try {
                    await auth.signOut();
                } catch (error) {
                    alert('Error signing out: ' + error.message);
                }
            };

            // Filtered history
            const filteredHistory = useMemo(() => {
                return history.filter(entry => {
                    const matchClient = !filters.client || entry.client === filters.client;
                    const matchProject = !filters.project || entry.project === filters.project;
                    
                    let matchDate = true;
                    if (filters.startDate || filters.endDate) {
                        const entryDate = new Date(entry.startTime);
                        if (filters.startDate) {
                            matchDate = matchDate && entryDate >= new Date(filters.startDate);
                        }
                        if (filters.endDate) {
                            const endDate = new Date(filters.endDate);
                            endDate.setHours(23, 59, 59, 999);
                            matchDate = matchDate && entryDate <= endDate;
                        }
                    }
                    
                    return matchClient && matchProject && matchDate;
                });
            }, [history, filters]);

            const activeClients = useMemo(() => {
                return clients.filter(c => c.active).sort((a, b) => a.name.localeCompare(b.name));
            }, [clients]);

            const activeProjects = useMemo(() => {
                return projects.filter(p => p.active).sort((a, b) => a.name.localeCompare(b.name));
            }, [projects]);

            const projectsForClient = useMemo(() => {
                if (!currentEntry.client) return [];
                return activeProjects.filter(p => p.client === currentEntry.client);
            }, [currentEntry.client, activeProjects]);

            const formatTime = (ms) => {
                const totalSeconds = Math.floor(ms / 1000);
                const hours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = totalSeconds % 60;
                return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            };

            const formatDecimalHours = (ms) => {
                return (ms / (1000 * 60 * 60)).toFixed(2);
            };

            const handleStartStop = async () => {
                if (!user) return;

                if (isTracking) {
                    const endTime = Date.now();
                    const duration = endTime - startTime;
                    
                    if (currentEntry.client && currentEntry.project) {
                        const project = projects.find(p => p.name === currentEntry.project && p.client === currentEntry.client);
                        const client = clients.find(c => c.name === currentEntry.client);
                        const rate = project?.rate || client?.rate || 0;
                        
                        const entry = {
                            client: currentEntry.client,
                            project: currentEntry.project,
                            notes: currentEntry.notes,
                            startTime: new Date(startTime).toISOString(),
                            endTime: new Date(endTime).toISOString(),
                            duration: duration,
                            rate: parseFloat(rate)
                        };
                        
                        await database.ref(`users/${user.uid}/history`).push(entry);
                        setCurrentEntry({ client: '', project: '', notes: '' });
                    }
                    
                    setIsTracking(false);
                    setCurrentTime(0);
                    setStartTime(null);
                } else {
                    if (currentEntry.client && currentEntry.project) {
                        setIsTracking(true);
                        setStartTime(Date.now());
                    } else {
                        alert('Please select a client and project before starting the timer.');
                    }
                }
            };

            const deleteEntry = async (id) => {
                if (!user) return;
                if (confirm('Are you sure you want to delete this entry?')) {
                    await database.ref(`users/${user.uid}/history/${id}`).remove();
                }
            };

            const openClientModal = (client = null) => {
                if (client) {
                    setEditingClient(client);
                    setClientForm(client);
                } else {
                    setEditingClient(null);
                    setClientForm({ name: '', rate: '', notes: '', active: true });
                }
                setShowClientModal(true);
            };

            const saveClient = async () => {
                if (!user) return;
                if (!clientForm.name) {
                    alert('Please enter a client name.');
                    return;
                }

                if (editingClient) {
                    await database.ref(`users/${user.uid}/clients/${editingClient.id}`).update(clientForm);
                } else {
                    await database.ref(`users/${user.uid}/clients`).push(clientForm);
                }
                
                setShowClientModal(false);
            };

            const deleteClient = async (id) => {
                if (!user) return;
                const clientName = clients.find(c => c.id === id)?.name;
                const hasProjects = projects.some(p => p.client === clientName);
                const hasEntries = history.some(h => h.client === clientName);
                
                if (hasProjects || hasEntries) {
                    alert('Cannot delete client with associated projects or time entries. Please deactivate instead.');
                    return;
                }
                
                if (confirm('Are you sure you want to delete this client?')) {
                    await database.ref(`users/${user.uid}/clients/${id}`).remove();
                }
            };

            const openProjectModal = (project = null) => {
                if (project) {
                    setEditingProject(project);
                    setProjectForm(project);
                } else {
                    setEditingProject(null);
                    setProjectForm({ name: '', client: '', rate: '', notes: '', active: true });
                }
                setShowProjectModal(true);
            };

            const saveProject = async () => {
                if (!user) return;
                if (!projectForm.name || !projectForm.client) {
                    alert('Please enter a project name and select a client.');
                    return;
                }

                if (editingProject) {
                    await database.ref(`users/${user.uid}/projects/${editingProject.id}`).update(projectForm);
                } else {
                    await database.ref(`users/${user.uid}/projects`).push(projectForm);
                }
                
                setShowProjectModal(false);
            };

            const deleteProject = async (id) => {
                if (!user) return;
                const project = projects.find(p => p.id === id);
                const hasEntries = history.some(h => h.client === project?.client && h.project === project?.name);
                
                if (hasEntries) {
                    alert('Cannot delete project with time entries. Please deactivate instead.');
                    return;
                }
                
                if (confirm('Are you sure you want to delete this project?')) {
                    await database.ref(`users/${user.uid}/projects/${id}`).remove();
                }
            };

            const getTotalHours = (entries = history) => {
                const total = entries.reduce((sum, entry) => sum + entry.duration, 0);
                return (total / (1000 * 60 * 60)).toFixed(1);
            };

            const getTotalRevenue = (entries = history) => {
                const total = entries.reduce((sum, entry) => {
                    const hours = entry.duration / (1000 * 60 * 60);
                    return sum + (hours * (entry.rate || 0));
                }, 0);
                return total.toFixed(2);
            };

            const getTotalEntries = (entries = history) => {
                return entries.length;
            };

            const formatDate = (isoString) => {
                const date = new Date(isoString);
                return date.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric', 
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            };

            const clearFilters = () => {
                setFilters({
                    client: '',
                    project: '',
                    startDate: '',
                    endDate: ''
                });
            };

            const hasActiveFilters = () => {
                return filters.client || filters.project || filters.startDate || filters.endDate;
            };

            const exportToExcel = (reportType) => {
                const dataToExport = filteredHistory;
                
                if (dataToExport.length === 0) {
                    alert('No data to export. Please adjust your filters or add time entries.');
                    return;
                }

                let worksheetData = [];
                let filename = '';

                if (reportType === 'detailed') {
                    filename = `TimeClock_Detailed_${new Date().toISOString().split('T')[0]}.xlsx`;
                    
                    worksheetData = [
                        ['Time Clock - Detailed Report'],
                        [`Generated: ${new Date().toLocaleString()}`],
                        [],
                        ['Client', 'Project', 'Start Time', 'End Time', 'Duration (HH:MM:SS)', 'Hours', 'Rate', 'Amount', 'Notes'],
                        ...dataToExport.map(entry => {
                            const hours = parseFloat(formatDecimalHours(entry.duration));
                            const amount = hours * (entry.rate || 0);
                            return [
                                entry.client,
                                entry.project,
                                new Date(entry.startTime).toLocaleString(),
                                new Date(entry.endTime).toLocaleString(),
                                formatTime(entry.duration),
                                hours,
                                entry.rate || 0,
                                amount,
                                entry.notes || ''
                            ];
                        }),
                        [],
                        ['Total Hours:', '', '', '', '', parseFloat(getTotalHours(dataToExport)), '', parseFloat(getTotalRevenue(dataToExport)), '']
                    ];
                } else if (reportType === 'summary') {
                    filename = `TimeClock_ClientSummary_${new Date().toISOString().split('T')[0]}.xlsx`;
                    
                    const clientSummary = {};
                    dataToExport.forEach(entry => {
                        if (!clientSummary[entry.client]) {
                            clientSummary[entry.client] = {
                                totalDuration: 0,
                                totalAmount: 0,
                                entries: 0,
                                projects: new Set()
                            };
                        }
                        const hours = entry.duration / (1000 * 60 * 60);
                        clientSummary[entry.client].totalDuration += entry.duration;
                        clientSummary[entry.client].totalAmount += hours * (entry.rate || 0);
                        clientSummary[entry.client].entries += 1;
                        clientSummary[entry.client].projects.add(entry.project);
                    });

                    worksheetData = [
                        ['Time Clock - Client Summary Report'],
                        [`Generated: ${new Date().toLocaleString()}`],
                        [],
                        ['Client', 'Total Hours', 'Total Amount', 'Number of Sessions', 'Projects'],
                        ...Object.keys(clientSummary).sort().map(client => [
                            client,
                            parseFloat(formatDecimalHours(clientSummary[client].totalDuration)),
                            clientSummary[client].totalAmount.toFixed(2),
                            clientSummary[client].entries,
                            Array.from(clientSummary[client].projects).join(', ')
                        ]),
                        [],
                        ['Grand Total:', parseFloat(getTotalHours(dataToExport)), parseFloat(getTotalRevenue(dataToExport)), dataToExport.length, '']
                    ];
                } else if (reportType === 'project') {
                    filename = `TimeClock_ProjectSummary_${new Date().toISOString().split('T')[0]}.xlsx`;
                    
                    const projectSummary = {};
                    dataToExport.forEach(entry => {
                        const key = `${entry.client}|${entry.project}`;
                        if (!projectSummary[key]) {
                            projectSummary[key] = {
                                client: entry.client,
                                project: entry.project,
                                totalDuration: 0,
                                totalAmount: 0,
                                entries: 0,
                                rate: entry.rate || 0
                            };
                        }
                        const hours = entry.duration / (1000 * 60 * 60);
                        projectSummary[key].totalDuration += entry.duration;
                        projectSummary[key].totalAmount += hours * (entry.rate || 0);
                        projectSummary[key].entries += 1;
                    });

                    worksheetData = [
                        ['Time Clock - Project Summary Report'],
                        [`Generated: ${new Date().toLocaleString()}`],
                        [],
                        ['Client', 'Project', 'Total Hours', 'Rate', 'Total Amount', 'Sessions'],
                        ...Object.values(projectSummary)
                            .sort((a, b) => a.client.localeCompare(b.client) || a.project.localeCompare(b.project))
                            .map(item => [
                                item.client,
                                item.project,
                                parseFloat(formatDecimalHours(item.totalDuration)),
                                item.rate,
                                item.totalAmount.toFixed(2),
                                item.entries
                            ]),
                        [],
                        ['Grand Total:', '', parseFloat(getTotalHours(dataToExport)), '', parseFloat(getTotalRevenue(dataToExport)), dataToExport.length]
                    ];
                } else if (reportType === 'quickbooks') {
                    filename = `TimeClock_QuickBooks_${new Date().toISOString().split('T')[0]}.xlsx`;
                    
                    worksheetData = [
                        ['Customer', 'Service Date', 'Service Item', 'Description', 'Quantity (Hours)', 'Rate', 'Amount', 'Taxable'],
                        ...dataToExport.map(entry => {
                            const hours = parseFloat(formatDecimalHours(entry.duration));
                            const amount = hours * (entry.rate || 0);
                            return [
                                entry.client,
                                new Date(entry.startTime).toLocaleDateString(),
                                entry.project,
                                entry.notes || `${entry.project} - ${formatTime(entry.duration)}`,
                                hours,
                                entry.rate || 0,
                                amount,
                                'No'
                            ];
                        })
                    ];
                }

                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(worksheetData);

                ws['!cols'] = [
                    { wch: 20 },
                    { wch: 20 },
                    { wch: 20 },
                    { wch: 30 },
                    { wch: 15 },
                    { wch: 10 },
                    { wch: 10 },
                    { wch: 12 },
                    { wch: 40 }
                ];

                XLSX.utils.book_append_sheet(wb, ws, 'Time Report');
                XLSX.writeFile(wb, filename);
            };

            if (loading) {
                return (
                    <div className="app-container">
                        <div className="empty-state">
                            <div className="empty-state-icon">⏱️</div>
                            <p>Loading...</p>
                        </div>
                    </div>
                );
            }

            if (!user) {
                return (
                    <div className="app-container">
                        <header>
                            <h1>Time Clock</h1>
                            <p className="subtitle">Track your hours across all devices with cloud sync</p>
                        </header>
                        <div className="auth-container">
                            <h2 className="auth-title">Sign In</h2>
                            <p style={{color: 'var(--text-secondary)', marginBottom: '2rem'}}>
                                Sign in with Google to sync your time entries across all your devices
                            </p>
                            <div className="auth-buttons">
                                <button className="btn btn-primary" onClick={signInWithGoogle}>
                                    Sign in with Google
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="app-container">
                    <header>
                        <h1>Time Clock</h1>
                        <p className="subtitle">Track your hours, clients, and projects with precision</p>
                        <div className="sync-indicator">
                            <span className="sync-dot"></span>
                            Synced across devices
                        </div>
                    </header>

                    <div className="user-info">
                        <span className="user-email">{user.email}</span>
                        <button className="btn btn-secondary btn-small" onClick={signOut}>
                            Sign Out
                        </button>
                    </div>

                    <nav className="nav-tabs">
                        <button 
                            className={`nav-tab ${currentPage === 'timeclock' ? 'active' : ''}`}
                            onClick={() => setCurrentPage('timeclock')}
                        >
                            ⏱️ Time Clock
                        </button>
                        <button 
                            className={`nav-tab ${currentPage === 'settings' ? 'active' : ''}`}
                            onClick={() => setCurrentPage('settings')}
                        >
                            ⚙️ Clients & Projects
                        </button>
                    </nav>

                    {currentPage === 'timeclock' && (
                        <div className="page-content">
                            <div className="main-grid">
                                <div className="card">
                                    <h2 className="card-title">Current Session</h2>
                                    
                                    <div className="time-display">
                                        <div className="timer">{formatTime(currentTime)}</div>
                                        <div className={`status-indicator ${isTracking ? 'active' : 'inactive'}`}>
                                            <span className="status-dot"></span>
                                            {isTracking ? 'Tracking Time' : 'Not Tracking'}
                                        </div>
                                    </div>

                                    <div className="form-group">
                                        <label>Client</label>
                                        <select
                                            value={currentEntry.client}
                                            onChange={(e) => setCurrentEntry({...currentEntry, client: e.target.value, project: ''})}
                                            disabled={isTracking}
                                        >
                                            <option value="">Select a client</option>
                                            {activeClients.map(client => (
                                                <option key={client.id} value={client.name}>{client.name}</option>
                                            ))}
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label>Project</label>
                                        <select
                                            value={currentEntry.project}
                                            onChange={(e) => setCurrentEntry({...currentEntry, project: e.target.value})}
                                            disabled={isTracking || !currentEntry.client}
                                        >
                                            <option value="">Select a project</option>
                                            {projectsForClient.map(project => (
                                                <option key={project.id} value={project.name}>{project.name}</option>
                                            ))}
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label>Notes (Optional)</label>
                                        <textarea
                                            placeholder="Add any notes about this work session..."
                                            value={currentEntry.notes}
                                            onChange={(e) => setCurrentEntry({...currentEntry, notes: e.target.value})}
                                            disabled={isTracking}
                                        />
                                    </div>

                                    <button 
                                        className={`btn ${isTracking ? 'btn-danger' : 'btn-success'}`}
                                        onClick={handleStartStop}
                                    >
                                        {isTracking ? '⏹ Stop Tracking' : '▶ Start Tracking'}
                                    </button>
                                </div>

                                <div className="card">
                                    <h2 className="card-title">Reports & History</h2>
                                    
                                    <div className="filters-section">
                                        <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem'}}>
                                            <h3 style={{fontSize: '1.1rem', fontWeight: 600}}>📊 Filter Reports</h3>
                                            {hasActiveFilters() && (
                                                <button className="clear-filters" onClick={clearFilters}>
                                                    ✕ Clear Filters
                                                </button>
                                            )}
                                        </div>
                                        
                                        <div className="filters-grid">
                                            <div className="filter-group">
                                                <label className="filter-label">Client</label>
                                                <select 
                                                    value={filters.client}
                                                    onChange={(e) => setFilters({...filters, client: e.target.value})}
                                                >
                                                    <option value="">All Clients</option>
                                                    {activeClients.map(client => (
                                                        <option key={client.id} value={client.name}>{client.name}</option>
                                                    ))}
                                                </select>
                                            </div>
                                            
                                            <div className="filter-group">
                                                <label className="filter-label">Project</label>
                                                <select 
                                                    value={filters.project}
                                                    onChange={(e) => setFilters({...filters, project: e.target.value})}
                                                >
                                                    <option value="">All Projects</option>
                                                    {activeProjects.map(project => (
                                                        <option key={project.id} value={project.name}>{project.name}</option>
                                                    ))}
                                                </select>
                                            </div>
                                            
                                            <div className="filter-group">
                                                <label className="filter-label">Start Date</label>
                                                <input 
                                                    type="date"
                                                    value={filters.startDate}
                                                    onChange={(e) => setFilters({...filters, startDate: e.target.value})}
                                                />
                                            </div>
                                            
                                            <div className="filter-group">
                                                <label className="filter-label">End Date</label>
                                                <input 
                                                    type="date"
                                                    value={filters.endDate}
                                                    onChange={(e) => setFilters({...filters, endDate: e.target.value})}
                                                />
                                            </div>
                                        </div>

                                        <div className="export-section">
                                            <button 
                                                className="btn btn-export"
                                                onClick={() => exportToExcel('detailed')}
                                            >
                                                📄 Detailed Report
                                            </button>
                                            <button 
                                                className="btn btn-export"
                                                onClick={() => exportToExcel('summary')}
                                            >
                                                📊 Client Summary
                                            </button>
                                            <button 
                                                className="btn btn-export"
                                                onClick={() => exportToExcel('project')}
                                            >
                                                📁 Project Summary
                                            </button>
                                            <button 
                                                className="btn btn-export"
                                                onClick={() => exportToExcel('quickbooks')}
                                                style={{background: 'linear-gradient(135deg, #2CA01C, #4CAF50)'}}
                                            >
                                                💼 QuickBooks Format
                                            </button>
                                        </div>
                                    </div>

                                    <div className="stats-grid">
                                        <div className="stat-card">
                                            <div className="stat-value">{getTotalHours(filteredHistory)}h</div>
                                            <div className="stat-label">Total Hours</div>
                                        </div>
                                        <div className="stat-card">
                                            <div className="stat-value">${getTotalRevenue(filteredHistory)}</div>
                                            <div className="stat-label">Revenue</div>
                                        </div>
                                        <div className="stat-card">
                                            <div className="stat-value">{getTotalEntries(filteredHistory)}</div>
                                            <div className="stat-label">Sessions</div>
                                        </div>
                                    </div>

                                    <div className="history-list">
                                        {filteredHistory.length === 0 ? (
                                            <div className="empty-state">
                                                <div className="empty-state-icon">⏱️</div>
                                                <p>
                                                    {history.length === 0 
                                                        ? 'No time entries yet. Start tracking to see your history here.'
                                                        : 'No entries match your filters. Try adjusting the filter criteria.'}
                                                </p>
                                            </div>
                                        ) : (
                                            filteredHistory.map((entry, index) => {
                                                const hours = parseFloat(formatDecimalHours(entry.duration));
                                                const amount = hours * (entry.rate || 0);
                                                return (
                                                    <div 
                                                        key={entry.id} 
                                                        className="history-item"
                                                        style={{animationDelay: `${Math.min(index * 0.1, 2)}s`}}
                                                    >
                                                        <div className="history-header">
                                                            <div>
                                                                <div className="history-client">{entry.client}</div>
                                                                <div className="history-project">📁 {entry.project}</div>
                                                                <div className="history-time">
                                                                    {formatDate(entry.startTime)} → {formatDate(entry.endTime)}
                                                                </div>
                                                                {entry.rate > 0 && (
                                                                    <div style={{marginTop: '0.5rem', color: 'var(--success)', fontWeight: 600}}>
                                                                        ${entry.rate}/hr × {hours}h = ${amount.toFixed(2)}
                                                                    </div>
                                                                )}
                                                            </div>
                                                            <div style={{display: 'flex', alignItems: 'center', gap: '1rem'}}>
                                                                <div className="history-duration">{formatTime(entry.duration)}</div>
                                                                <button 
                                                                    className="delete-btn"
                                                                    onClick={() => deleteEntry(entry.id)}
                                                                    title="Delete entry"
                                                                >
                                                                    ✕
                                                                </button>
                                                            </div>
                                                        </div>
                                                        {entry.notes && (
                                                            <div className="history-notes">
                                                                💭 {entry.notes}
                                                            </div>
                                                        )}
                                                    </div>
                                                );
                                            })
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {currentPage === 'settings' && (
                        <div className="page-content">
                            <div className="settings-grid">
                                <div className="settings-section">
                                    <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center'}}>
                                        <h3>👥 Clients</h3>
                                        <button className="btn btn-primary btn-small" onClick={() => openClientModal()}>
                                            + Add Client
                                        </button>
                                    </div>
                                    
                                    <div className="item-list">
                                        {clients.length === 0 ? (
                                            <div className="empty-state">
                                                <p>No clients yet. Add your first client to get started.</p>
                                            </div>
                                        ) : (
                                            clients.map(client => (
                                                <div key={client.id} className="item-card">
                                                    <div className="item-header">
                                                        <div>
                                                            <span className="item-name">{client.name}</span>
                                                            {' '}
                                                            <span className={`badge ${client.active ? 'badge-active' : 'badge-inactive'}`}>
                                                                {client.active ? 'Active' : 'Inactive'}
                                                            </span>
                                                        </div>
                                                        {client.rate && (
                                                            <div className="item-rate">${client.rate}/hr</div>
                                                        )}
                                                    </div>
                                                    {client.notes && (
                                                        <div className="item-details">{client.notes}</div>
                                                    )}
                                                    <div className="item-actions">
                                                        <button 
                                                            className="btn btn-edit btn-small"
                                                            onClick={() => openClientModal(client)}
                                                        >
                                                            Edit
                                                        </button>
                                                        <button 
                                                            className="btn btn-delete btn-small"
                                                            onClick={() => deleteClient(client.id)}
                                                        >
                                                            Delete
                                                        </button>
                                                    </div>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                </div>

                                <div className="settings-section">
                                    <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center'}}>
                                        <h3>📁 Projects</h3>
                                        <button className="btn btn-primary btn-small" onClick={() => openProjectModal()}>
                                            + Add Project
                                        </button>
                                    </div>
                                    
                                    <div className="item-list">
                                        {projects.length === 0 ? (
                                            <div className="empty-state">
                                                <p>No projects yet. Add your first project to get started.</p>
                                            </div>
                                        ) : (
                                            projects.map(project => (
                                                <div key={project.id} className="item-card">
                                                    <div className="item-header">
                                                        <div>
                                                            <span className="item-name">{project.name}</span>
                                                            {' '}
                                                            <span className={`badge ${project.active ? 'badge-active' : 'badge-inactive'}`}>
                                                                {project.active ? 'Active' : 'Inactive'}
                                                            </span>
                                                        </div>
                                                        {project.rate && (
                                                            <div className="item-rate">${project.rate}/hr</div>
                                                        )}
                                                    </div>
                                                    <div className="item-details">
                                                        <strong>Client:</strong> {project.client}
                                                    </div>
                                                    {project.notes && (
                                                        <div className="item-details">{project.notes}</div>
                                                    )}
                                                    <div className="item-actions">
                                                        <button 
                                                            className="btn btn-edit btn-small"
                                                            onClick={() => openProjectModal(project)}
                                                        >
                                                            Edit
                                                        </button>
                                                        <button 
                                                            className="btn btn-delete btn-small"
                                                            onClick={() => deleteProject(project.id)}
                                                        >
                                                            Delete
                                                        </button>
                                                    </div>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {showClientModal && (
                        <div className="modal-overlay" onClick={() => setShowClientModal(false)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h2 className="modal-title">{editingClient ? 'Edit Client' : 'Add Client'}</h2>
                                    <button className="modal-close" onClick={() => setShowClientModal(false)}>✕</button>
                                </div>

                                <div className="form-group">
                                    <label>Client Name *</label>
                                    <input
                                        type="text"
                                        placeholder="Enter client name"
                                        value={clientForm.name}
                                        onChange={(e) => setClientForm({...clientForm, name: e.target.value})}
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Default Hourly Rate</label>
                                    <div className="input-group">
                                        <span className="input-addon">$</span>
                                        <input
                                            type="number"
                                            placeholder="0.00"
                                            step="0.01"
                                            value={clientForm.rate}
                                            onChange={(e) => setClientForm({...clientForm, rate: e.target.value})}
                                        />
                                    </div>
                                </div>

                                <div className="form-group">
                                    <label>Notes</label>
                                    <textarea
                                        placeholder="Add any notes about this client..."
                                        value={clientForm.notes}
                                        onChange={(e) => setClientForm({...clientForm, notes: e.target.value})}
                                    />
                                </div>

                                <div className="form-group">
                                    <label style={{display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer'}}>
                                        <input
                                            type="checkbox"
                                            checked={clientForm.active}
                                            onChange={(e) => setClientForm({...clientForm, active: e.target.checked})}
                                        />
                                        Active
                                    </label>
                                </div>

                                <div className="modal-actions">
                                    <button className="btn btn-secondary" onClick={() => setShowClientModal(false)}>
                                        Cancel
                                    </button>
                                    <button className="btn btn-primary" onClick={saveClient}>
                                        {editingClient ? 'Update' : 'Create'} Client
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showProjectModal && (
                        <div className="modal-overlay" onClick={() => setShowProjectModal(false)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h2 className="modal-title">{editingProject ? 'Edit Project' : 'Add Project'}</h2>
                                    <button className="modal-close" onClick={() => setShowProjectModal(false)}>✕</button>
                                </div>

                                <div className="form-group">
                                    <label>Client *</label>
                                    <select
                                        value={projectForm.client}
                                        onChange={(e) => setProjectForm({...projectForm, client: e.target.value})}
                                    >
                                        <option value="">Select a client</option>
                                        {clients.map(client => (
                                            <option key={client.id} value={client.name}>{client.name}</option>
                                        ))}
                                    </select>
                                </div>

                                <div className="form-group">
                                    <label>Project Name *</label>
                                    <input
                                        type="text"
                                        placeholder="Enter project name"
                                        value={projectForm.name}
                                        onChange={(e) => setProjectForm({...projectForm, name: e.target.value})}
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Project Hourly Rate (overrides client rate)</label>
                                    <div className="input-group">
                                        <span className="input-addon">$</span>
                                        <input
                                            type="number"
                                            placeholder="0.00"
                                            step="0.01"
                                            value={projectForm.rate}
                                            onChange={(e) => setProjectForm({...projectForm, rate: e.target.value})}
                                        />
                                    </div>
                                </div>

                                <div className="form-group">
                                    <label>Notes</label>
                                    <textarea
                                        placeholder="Add any notes about this project..."
                                        value={projectForm.notes}
                                        onChange={(e) => setProjectForm({...projectForm, notes: e.target.value})}
                                    />
                                </div>

                                <div className="form-group">
                                    <label style={{display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer'}}>
                                        <input
                                            type="checkbox"
                                            checked={projectForm.active}
                                            onChange={(e) => setProjectForm({...projectForm, active: e.target.checked})}
                                        />
                                        Active
                                    </label>
                                </div>

                                <div className="modal-actions">
                                    <button className="btn btn-secondary" onClick={() => setShowProjectModal(false)}>
                                        Cancel
                                    </button>
                                    <button className="btn btn-primary" onClick={saveProject}>
                                        {editingProject ? 'Update' : 'Create'} Project
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>